<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>FriendFinder</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>

<body>
  <div class="container">
    <h1 class="text-center">Take the Survey</h1>
    <hr>
    <form role="form" id="quiz">
      <h2>Tell us about yourself first</h2>
      <div class="form-group">
        <label for="user">Name: (Required)</label>
        <input type="text" class="form-control" id="user">
      </div>
      <div class="form-group">
        <label for="upic">Link your photo: (Required)</label>
        <input type="text" class="form-control" id="pic">
      </div>
      <hr>
      
      <h2>Provide responses to the following statements:</h2>
      
      <div class="row col-xs-12">
        <h3>Question 1</h3>
        <h4>How long does it take you to feel comfortable with a new person?</h4>
        <div class="form-group col-xs-3">
          <select class="form-control" id="quest1">
            <option>1 (a few days)</option>
            <option>2 (1 week or so)</option>
            <option>3 (< 1 month)</option>
            <option>4 (1-3 months)</option>
            <option>5 (> 3 months)</option>
           </select>
        </div>
        
        <div class="row col-xs-12">
        <h3>Question 2</h3>
        <h4>What is the first thing you mostly say when you meet a person for the first time?</h4>
        <div class="form-group col-xs-3">
          <select class="form-control" id="quest1">
            <option>1 (hobbies)</option>
            <option>2 (job)</option>
            <option>3 (family)</option>
            <option>4 (likes/dislikes)</option>
            <option>5 (future plans)</option>
           </select>
        </div>
          
          <div class="row col-xs-12">
        <h3>Question 3</h3>
        <h4>What's your ice-breaker idea?</h4>
        <div class="form-group col-xs-3">
          <select class="form-control" id="quest1">
            <option>1 (food)</option>
            <option>2 (movies)</option>
            <option>3 (hobbies)</option>
            <option>4 (travel)</option>
            <option>5 (workout)</option>
           </select>
        </div>
            
            <div class="row col-xs-12">
        <h3>Question 4</h3>
        <h4>Are you a social person? How often do you spend with your friends?</h4>
        <div class="form-group col-xs-3">
          <select class="form-control" id="quest1">
            <option>1 (a few times/week)</option>
            <option>2 (1/week)</option>
            <option>3 (a few times/month)</option>
            <option>4 (every 1-3 months)</option>
            <option>5 (a few times a year)</option>
           </select>
        </div>
              
              <div class="row col-xs-12">
        <h3>Question 5</h3>
        <h4>What's the most important thing in your life?</h4>
        <div class="form-group col-xs-3">
          <select class="form-control" id="quest1">
            <option>1 (vacation)</option>
            <option>2 (health)</option>
            <option>3 (finance)</option>
            <option>4 (happiness)</option>
            <option>5 (relationship)</option>
           </select>
        </div>
                
                <div class="row col-xs-12">
        <h3>Question 6</h3>
        <h4>How long does it take you to feel comfortable with a new job?</h4>
        <div class="form-group col-xs-3">
          <select class="form-control" id="quest1">
            <option>1 (a few days)</option>
            <option>2 (1 week or so)</option>
            <option>3 (< 1 month)</option>
            <option>4 (1-3 months)</option>
            <option>5 (> 3 months)</option>
           </select>
        </div>
                  
                  <div class="row col-xs-12">
        <h3>Question 7</h3>
        <h4>What do you most remember about family as a kid?</h4>
        <div class="form-group col-xs-3">
          <select class="form-control" id="quest1">
            <option>1 (trips)</option>
            <option>2 (sports)</option>
            <option>3 (dinner)</option>
            <option>4 (events)</option>
            <option>5 (others)</option>
           </select>
        </div>
                    
        <div class="row col-xs-12">
        <h3>Question 8</h3>
        <h4>Which day of the year are you most likely to spend with your family?</h4>
        <div class="form-group col-xs-3">
          <select class="form-control" id="quest1">
            <option>1 (birthday)</option>
            <option>2 (New Year)</option>
            <option>3 (Christmas)</option>
            <option>4 (Thanksgiving)</option>
            <option>5 (Others)</option>
           </select>
        </div>
          
          <div class="row col-xs-12">
        <h3>Question 9</h3>
        <h4>What characteristics have you inherited most from your parent(guy: dad, girl: mom)?</h4>
        <div class="form-group col-xs-3">
          <select class="form-control" id="quest1">
            <option>1 (habits)</option>
            <option>2 (personality)</option>
            <option>3 (appearance)</option>
            <option>4 (lifestyle)</option>
            <option>5 (others)</option>
           </select>
        </div>
            
            <div class="row col-xs-12">
        <h3>Question 10</h3>
        <h4>What are you most proud of yourself?</h4>
        <div class="form-group col-xs-3">
          <select class="form-control" id="quest1">
            <option>1 (financial stability)</option>
            <option>2 (health)</option>
            <option>3 (emotional stability)</option>
            <option>4 (social life)</option>
            <option>5 (jobs/future plans)</option>
           </select>
        </div>      
      </div>
            <button type="button" class="btn btn-info btn-block" id="submit">Let's find out!</button>
            </form>
          
          <!-- Modal -->
<div class="modal fade" id="friendModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Your best match: <span id="match"></span></h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modalBody">
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
      
 <div class="footer text-center">
   <p>Youngmi Lee &copy;</p>
 </div>
 
          
          
  </div>
  
  <script style="text/javascript">
    $("#submit").on("click", function() {
  var validEntry;
  if($("#name").val().trim() === "") {
    alert("Please enter a name");
  }
  else if($("#pic").val().trim() === "") {
    alert("Please enter a link to photo");
  }
  
  else {
    var answerArray = [];
    for (var i = 0; i < 11; i++) {
      console.log("#quest" + i);
      answerArray.push($("#quest" + i).val().substring(0, 1));   
    }
    
    var newFriend = {
      name: $("#name").val().trim(),
      photo: $("#pic").val().trim(),
      scores: answerArray
    }
    
    var currentURL = window.location.origin;
    $.post(currentURL + "/api/friends", newFriend, function(data) {});
    
    $.ajax({
      url: currentURL,
      method: "GET"
    }).done(function(res) {
      var futureLove;
      var currentBest = 100;
      var differenceArray = [];
      
      for(var i = 0; i < res.length; i++) {
        for(var j = 0; j < 10; j++) {
          var currentDifference = newFriend.score[j] - res[i].score[j];
          differenceArray.push(Math.abs(currentDifference));
        }
        
        var difference = differenceArray.reduce(add, 0); // needs function add()
        
        if(difference < currentBest) {
          futureLove = res[i];
          currentBest = difference;
          differenceArray = [];
        }
        else {
          differenceArray = [];
        }
      }
      
      var loveName = "<h4>" + futureLove.name + "</h4>";
      var lovePic = "<img width = '300px' src=" + futureLove.photo + ">";
      
      $("#friendModal").modal(show);
      $("#match").html(loveName);
      ("#modalBody").html(lovePic);
      $("#quiz")[0].reset();
      
    });
    
  }
  return false;
});

function add(a, b) {
  return a + b;
}
    
  </script>
  
</body>
</html>